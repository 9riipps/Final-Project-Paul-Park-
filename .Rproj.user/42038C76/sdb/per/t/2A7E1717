{
    "contents" : "# =====================================================\n# Stat133: Final Project\n# Description: Visualization\n# =====================================================\n\n# Name: Paul Park\n# SID : 23046317\n\n# =====================================================\n#  Pre processing of data\n# =====================================================\n# call the package \"maps\" and \"ggplot2\"\nlibrary(\"maps\")\nlibrary(\"ggplot2\")\nlibrary(\"dplyr\")\n\n# assign data of East Pacific basins to \"raw2\" and those of North Atlantic basins to \"raw3\"\nraw2 <- read.csv(\"rawdata/rawdata2.csv\", header = FALSE, stringsAsFactors = FALSE)\nraw3 <- read.csv(\"rawdata/rawdata3.csv\", header = FALSE, stringsAsFactors = FALSE)\n\n# manipulate the files so that they are easier to work with\nraw2 <- raw2[, c(1, 7, 9, 10, 11)]\nraw3 <- raw3[, c(1, 7, 9, 10, 11)]\n\ncolnames(raw2) <- c(\"id\", \"date\", \"lat\", \"long\", \"wind\")\ncolnames(raw3) <- c(\"id\", \"date\", \"lat\", \"long\", \"wind\")\n\nraw2 <- raw2[-(1:3), ]\nraw3 <- raw3[-(1:3), ]\n\nraw2$long <- as.numeric(raw2$long)\nraw2$lat <- as.numeric(raw2$lat)\nraw2$wind <- as.numeric(raw2$wind)\nraw3$long <- as.numeric(raw3$long)\nraw3$lat <- as.numeric(raw3$lat)\nraw3$wind <- as.numeric(raw3$wind)\n\n# =====================================================\n# Plotting part\n\n# note that in all of the below graphs, warning messages\n# will show up saying some rows containing missing values\n# were removed. This is because the trajectories outside\n# the window limits were cut off from the graphs.\n# =====================================================\n# extract the rows only from 1980 to 2010\nextracted2_1 <- raw2[(head(which(substr(raw2$date, 1, 4) == 1980), 1):\n                      tail(which(substr(raw2$date, 1, 4) == 2010), 1)), ]\nextracted2_2 <- raw3[(head(which(substr(raw3$date, 1, 4) == 1980), 1):\n                      tail(which(substr(raw3$date, 1, 4) == 2010), 1)), ]\nextracted2 <- full_join(extracted2_1, extracted2_2)\n\n# make sure that the trajectories are all connected like they are meant to be\nextracted2$long[which(extracted2$long > 100)] <- extracted2$long[which(extracted2$long > 100)] - 360\n\n# produce a plot showing the trajectory of all storms(1980-2010)\nworld_map <- map_data(\"world\")\n\nggplot(extracted2, aes(x = long, y = lat, group = id)) +\n  geom_polygon(data = world_map, aes(x = long, y = lat, group = group)) +\n  geom_path(aes(col = wind)) +\n  scale_x_continuous(name = \"longitude\", limits = c(-180, 0), breaks = seq(-180, 0, by = 20)) +\n  scale_y_continuous(name = \"latitude\", limits = c(0, 90), breaks = seq(0, 90, by = 10)) +\n  theme(panel.background = element_rect(fill = '#FFFAFA')) +\n  ggtitle(\"The trajectory of all storms from 1980 to 2010\") +\n  coord_cartesian(xlim = c(-180, 0), ylim = c(0, 90)) +\n  ggsave(\"images/trajectory_all.png\") +\n  ggsave(\"images/trajectory_all.pdf\")\n\n# produce a plot showing the trajectory of all storms per month[1980-2010] (one facet per month)\nidcount2 <- numeric(0)\nfor (i in 1:length(unique(extracted2$id))) {\n  idcount2[i] <- length(which(extracted2$id == unique(extracted2$id)[i]))\n}\n\nextracted2$month <- numeric(nrow(extracted2))\nfor (i in 1:length(unique(extracted2$id))) {\n  extracted2$month[head(which(extracted2$id == unique(extracted2$id)[i]), 1)] <- \n    as.numeric(substr(head(extracted2$date[extracted2$id == unique(extracted2$id)[i]], 1), 6, 7))\n}\nmonth <- extracted2$month[-(which(extracted2$month == 0))]\nmonth <- rep(month, times = idcount2)\nextracted2$month <- month\n\nggplot(extracted2, aes(x = long, y = lat, group = id)) +\n  geom_polygon(data = world_map, aes(x = long, y = lat, group = group)) +\n  geom_path(aes(col = wind)) +\n  scale_x_continuous(name = \"longitude\", limits = c(-180, 0), breaks = seq(-180, 0, by = 45)) +\n  scale_y_continuous(name = \"latitude\", limits = c(0, 90), breaks = seq(0, 90, by = 10)) +\n  theme(panel.background = element_rect(fill = '#FFFAFA')) +\n  ggtitle(\"The trajectory of all storms per month from 1980 to 2010\") +\n  coord_cartesian(xlim = c(-180, 0), ylim = c(0, 90)) +\n  facet_wrap(~month) +\n  ggsave(\"images/trajectory_month.png\") +\n  ggsave(\"images/trajectory_month.pdf\")\n\n# produce a plot showing the trajectory of storms in decade 1980s (one facet per year)\nextracted3_1 <- raw2[(head(which(substr(raw2$date, 1, 4) == 1980), 1):\n                      tail(which(substr(raw2$date, 1, 4) == 1989), 1)), ]\nextracted3_2 <- raw3[(head(which(substr(raw3$date, 1, 4) == 1980), 1):\n                      tail(which(substr(raw3$date, 1, 4) == 1989), 1)), ]\nextracted3 <- full_join(extracted3_1, extracted3_2)\n\nextracted3$long[which(extracted3$long > 100)] <- extracted3$long[which(extracted3$long > 100)] - 360\n\nextracted3$year <- substr(extracted3$date, 1, 4)\n\n# you can check if there are occasions where storms started and ended in other years by using\nextracted3[substr(extracted3$date, 6, 7) == '01',]\n\nggplot(extracted3, aes(x = long, y = lat, group = id)) +\n  geom_polygon(data = world_map, aes(x = long, y = lat, group = group)) +\n  geom_path(aes(col = wind)) +\n  theme(panel.background = element_rect(fill = '#EEE5DE')) +\n  scale_x_continuous(name = \"longitude\", limits = c(-180, 0), breaks = seq(-180, 0, by = 45)) +\n  scale_y_continuous(name = \"latitude\", limits = c(0, 90), breaks = seq(0, 90, by = 10)) +\n  ggtitle(\"The trajectory of all storms from 1980 to 1989\") +\n  coord_cartesian(xlim = c(-180, 0), ylim = c(0, 90)) +\n  facet_wrap(~year) +\n  ggsave(\"images/trajectory_1980s.png\") +\n  ggsave(\"images/trajectory_1980s.pdf\")\n\n# produce a plot showing the trajectory of storms in decade 1990s (one facet per year)\nextracted4_1 <- raw2[(head(which(substr(raw2$date, 1, 4) == 1990), 1):\n                      tail(which(substr(raw2$date, 1, 4) == 1999), 1)), ]\nextracted4_2 <- raw3[(head(which(substr(raw3$date, 1, 4) == 1990), 1):\n                      tail(which(substr(raw3$date, 1, 4) == 1999), 1)), ]\nextracted4 <- full_join(extracted4_1, extracted4_2)\n\nextracted4$long[which(extracted4$long > 100)] <- extracted4$long[which(extracted4$long > 100)] - 360\n\nextracted4$year <- substr(extracted4$date, 1, 4)\n\n# you can check if there are occasions where storms started and ended in other years by using\nextracted4[substr(extracted4$date, 6, 7) == '01',]\n\nggplot(extracted4, aes(x = long, y = lat, group = id)) +\n  geom_polygon(data = world_map, aes(x = long, y = lat, group = group)) +\n  geom_path(aes(col = wind)) +\n  theme(panel.background = element_rect(fill = '#EEE5DE')) +\n  scale_x_continuous(name = \"longitude\", limits = c(-180, 0), breaks = seq(-180, 0, by = 45)) +\n  scale_y_continuous(name = \"latitude\", limits = c(0, 90), breaks = seq(0, 90, by = 10)) +\n  ggtitle(\"The trajectory of all storms from 1990 to 1999\") +\n  coord_cartesian(xlim = c(-180, 0), ylim = c(0, 90)) +\n  facet_wrap(~year) +\n  ggsave(\"images/trajectory_1990s.png\") +\n  ggsave(\"images/trajectory_1990s.pdf\")\n\n# produce a plot showing the trajectory of storms in decade 2000s (one facet per year)\nextracted5_1 <- raw2[(head(which(substr(raw2$date, 1, 4) == 2000), 1):\n                      tail(which(substr(raw2$date, 1, 4) == 2009), 1)), ]\nextracted5_2 <- raw3[(head(which(substr(raw3$date, 1, 4) == 2000), 1):\n                      tail(which(substr(raw3$date, 1, 4) == 2009), 1)), ]\nextracted5 <- full_join(extracted5_1, extracted5_2)\n\nextracted5$long[which(extracted5$long > 100)] <- extracted5$long[which(extracted5$long > 100)] - 360\n\nextracted5$year <- substr(extracted5$date, 1, 4)\n\n# you can check if there are occasions where storms started and ended in other years by using\nextracted5[substr(extracted5$date, 6, 7) == '01',]\n\nggplot(extracted5, aes(x = long, y = lat, group = id)) +\n  geom_polygon(data = world_map, aes(x = long, y = lat, group = group)) +\n  geom_path(aes(col = wind)) +\n  theme(panel.background = element_rect(fill = '#EEE5DE')) +\n  scale_x_continuous(name = \"longitude\", limits = c(-180, 0), breaks = seq(-180, 0, by = 45)) +\n  scale_y_continuous(name = \"latitude\", limits = c(0, 90), breaks = seq(0, 90, by = 10)) +\n  ggtitle(\"The trajectory of all storms from 2000 to 2009\") +\n  coord_cartesian(xlim = c(-180, 0), ylim = c(0, 90)) +\n  facet_wrap(~year) +\n  ggsave(\"images/trajectory_2000s.png\") +\n  ggsave(\"images/trajectory_2000s.pdf\")",
    "created" : 1439588981406.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3578425708",
    "id" : "2A7E1717",
    "lastKnownWriteTime" : 1439592407,
    "path" : "~/Desktop/Summer 2015/STAT 133/Final Project(Paul Park)/code/visualization.R",
    "project_path" : "code/visualization.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}